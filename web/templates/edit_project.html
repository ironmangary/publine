{% extends "base.html" %}

{% block title %}Edit Project - {{ project.title }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h1>Edit Project: {{ project.story_title }}</h1>
        <a href="{{ url_for('projects_bp.project_dashboard', slug=project.slug) }}" class="btn btn-secondary">Back to Project</a>
    </div>

    {% include 'flash_messages.html' %}

    {% if project %}
    <form action="{{ url_for('edit_project_bp.edit_project', slug=project.slug) }}" method="post" enctype="multipart/form-data">
        <div class="mb-3">
            <label for="title" class="form-label">Project Title:</label>
            <input type="text" class="form-control" id="title" name="title" value="{{ project.story_title }}" required>
        </div>
        <div class="mb-3">
            <label for="author" class="form-label">Author:</label>
            <input type="text" class="form-control" id="author" name="author" value="{{ project.story_author }}" required>
        </div>
        <div class="mb-3">
            <label for="copyright_year" class="form-label">Copyright Year:</label>
            <input type="number" class="form-control" id="copyright_year" name="copyright_year" value="{{ project.copyright_year }}" required min="1900" max="2100">
        </div>

        <div class="mb-3">
            <label for="cover_image" class="form-label">Default Cover Image (Optional):</label>
            <input type="file" class="form-control" id="cover_image" name="cover_image" accept="image/png, image/jpeg, image/gif, image/svg+xml">
            {% if project.cover_image %}
                <div class="form-text">Current: {{ project.cover_image }} (Uploading a new file will replace this)</div>
            {% endif %}
        </div>

        <div class="mb-3">
            <label for="custom_css" class="form-label">Default Custom CSS (Optional):</label>
            <input type="file" class="form-control" id="custom_css" name="custom_css" accept=".css">
            {% if project.custom_css %}
                <div class="form-text">Current: {{ project.custom_css }} (Uploading a new file will replace this)</div>
            {% endif %}
        </div>

        <div class="mb-3 form-check">
            <input type="checkbox" class="form-check-input" id="pdf_enabled" name="pdf_enabled" {% if project.pdf_enabled %}checked{% endif %}>
            <label class="form-check-label" for="pdf_enabled">Enable PDF Generation</label>
            <div class="form-text">
                Note: Enabling PDF generation on Windows requires installing GTK+ or similar dependencies for WeasyPrint. 
                <a href="https://weasyprint.readthedocs.io/en/stable/install.html#windows" target="_blank">See WeasyPrint documentation for details.</a>
            </div>
        </div>

        <button type="submit" class="btn btn-primary">Update Project</button>
    </form>
    {% else %}
    <div class="alert alert-warning">Project not found.</div>
    {% endif %}
</div>
{% endblock %}